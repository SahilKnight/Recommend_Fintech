<div class="subscription-page">
  <header class="page-header">
    <h1>Subscription Plans</h1>
    <nav class="breadcrumb">
      <a routerLink="/dashboard">Dashboard</a> > Subscription
    </nav>
  </header>

  <div class="current-plan" *ngIf="currentPlan && user$ | async as user">
    <div class="current-plan-card">
      <h2>Current Plan: {{ currentPlan?.name }}</h2>
      <div class="plan-details">
        <div class="price">₹{{ currentPlan?.price }}/month</div>
        <div class="trial-info" *ngIf="user.subscriptionType === 'TRIAL'">
          <span class="trial-badge">Trial Active</span>
          <span class="trial-days">{{ remainingTrialDays }} days remaining</span>
        </div>
      </div>
      <div class="current-features">
        <h4>Your Current Features:</h4>
        <ul>
          <li *ngFor="let feature of currentPlan?.features">{{ feature }}</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="plans-section">
    <h2>Choose Your Plan</h2>
    <div class="plans-grid">
      <div class="plan-card" 
           *ngFor="let plan of plans" 
           [class.recommended]="plan.recommended"
           [class.current]="isCurrentPlan(plan.id)">
        
        <div class="plan-header">
          <h3>{{ plan.name }}</h3>
          <div class="plan-badge" *ngIf="plan.recommended">Recommended</div>
          <div class="plan-badge current" *ngIf="isCurrentPlan(plan.id)">Current Plan</div>
        </div>

        <div class="plan-price">
          <span class="currency">₹</span>
          <span class="amount">{{ plan.price }}</span>
          <span class="period" *ngIf="plan.price > 0">/month</span>
          <span class="period" *ngIf="plan.price === 0">Free</span>
        </div>

        <div class="plan-features">
          <ul>
            <li *ngFor="let feature of plan.features">
              <span class="checkmark">✓</span>
              {{ feature }}
            </li>
          </ul>
        </div>

        <div class="plan-action">
          <button 
            class="btn-plan"
            [class.btn-primary]="!isCurrentPlan(plan.id)"
            [class.btn-current]="isCurrentPlan(plan.id)"
            [disabled]="isCurrentPlan(plan.id) || upgrading"
            (click)="upgradePlan(plan.id)">
            
            <span *ngIf="upgrading">Upgrading...</span>
            <span *ngIf="!upgrading && isCurrentPlan(plan.id)">Current Plan</span>
            <span *ngIf="!upgrading && !isCurrentPlan(plan.id) && plan.price === 0">Start Trial</span>
            <span *ngIf="!upgrading && !isCurrentPlan(plan.id) && plan.price > 0">Upgrade Now</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="faq-section">
    <h2>Frequently Asked Questions</h2>
    <div class="faq-grid">
      <div class="faq-item">
        <h4>Can I cancel anytime?</h4>
        <p>Yes, you can cancel your subscription at any time. You'll continue to have access until the end of your billing period.</p>
      </div>
      <div class="faq-item">
        <h4>What happens after my trial ends?</h4>
        <p>After your 3-day trial, you can choose to upgrade to a paid plan or your account will be limited to basic features.</p>
      </div>
      <div class="faq-item">
        <h4>Are there any setup fees?</h4>
        <p>No, there are no setup fees or hidden charges. You only pay the monthly subscription fee.</p>
      </div>
      <div class="faq-item">
        <h4>Can I upgrade or downgrade my plan?</h4>
        <p>Yes, you can change your plan at any time. Changes will be reflected in your next billing cycle.</p>
      </div>
    </div>
  </div>
</div>